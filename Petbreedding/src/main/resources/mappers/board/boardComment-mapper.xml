<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- 	private String coNum; -->
<!-- 	private String boNum; -->
<!-- 	private String clNickName; -->
<!-- 	private String coCont; -->
<!-- 	private String coDate; -->

<mapper namespace="boardComment">
	<resultMap type="boardComment" id="boardCommentMap">
		<id column="CO_NUM" property="coNum"/>
		<result column="BO_NUM" property="boNum"/>
		<result column="CL_NUM" property="clNickName"/>
		<result column="CO_CONT" property="coCont"/>
		<result column="CO_DATE" property="coDate"/>
	</resultMap>
	
	<resultMap type="MyAskComment" id="MyAskCommentMap">
		<id column="QNAC_NUM" property="qnacNum"/>
		<result column="ADMIN_ID" property="adminId"/>
		<result column="QNA_NUM" property="qnaNum"/>
		<result column="QNAC_CONT" property="qnacCont"/>
		<result column="QNAC_DATE" property="qnacDate"/>
	</resultMap>
	
		<!-- [관리자] 해당 자유 게시판의 댓글 조회  -->
	<select id="bCommentSelectListA" resultMap="MyAskCommentMap">
		SELECT * FROM BOARD_COMMENT
	</select>
	
	<!-- [고객] 해당 해당 자유 게시판의 댓글 조회 (JSON) -->
	<select id="bCommentSelectListC" parameterType="string" resultMap="MyAskCommentMap">
		SELECT * FROM BOARD_COMMENT WHERE BO_NUM = #{boNum}
	</select>
	
	<!-- 자유게시판 댓글 시퀀스 더미 테이블을 이용해 가져오기 -->
	<select id="getbCommentSeq" resultType="string">
		<![CDATA[
			SELECT 'CO'||SEQ_BOARD_COMMENT.NEXTVAL from DUAL
		]]>
	</select>
	
	<!-- 자유게시판 댓글 등록 -->
	<insert id="bCommentInsert" parameterType="boardComment">
		<![CDATA[
			INSERT INTO BOARD_COMMENT VALUES(
				#{coNum}, #{boNum}, #{clNickName}
				,#{coCont}, TO_CHAR(SYSDATE, 'YYYY-MM-DD')
		]]>
		)
	</insert>
	
	<!-- 자유게시판 댓글 개수 업데이트 -->
	<update id="bocChkUpdate" parameterType="string">
		<![CDATA[
			UPDATE BOARD SET BOC_CHK = (SELECT COUNT(*) FROM BOARD_COMMENT WHERE BO_NUM = #{boNum})
			WHERE BO_NUM = #{boNum}
		]]>
	</update>
	
</mapper>